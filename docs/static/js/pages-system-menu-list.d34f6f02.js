(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-system-menu-list"],{"083a":function(e,t,n){var i=n("df4d");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("967d").default;a("f4528cf8",i,!0,{sourceMap:!1,shadowMode:!1})},"25ed":function(e,t,n){"use strict";(function(e){n("6a54");var i=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n("26347")),s=i(n("9b1b")),o=i(n("2fdc")),r=i(n("b7c7"));n("bf0f"),n("2797"),n("de6c"),n("aa9c"),n("aa77"),n("fd3c"),n("a578"),n("c223"),n("d4b5");var u=n("e10e"),c=i(n("6af2")),d=e.database(),l=[];function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.forEach((function(i){i.menu_id===t&&i.parent_id&&(n=n+1+p(e,i.parent_id,n))})),n}var m={data:function(){return{query:"",where:"",orderby:"create_date asc",options:{pageSize:2e4,pageCurrent:1},selectedIndexs:[],loading:!0,menus:[],errMsg:"",currentTab:"menus",selectedPluginMenuIndexs:[]}},computed:{pluginMenus:function(){var e=[];if(!this.$hasRole("admin"))return e;var t=this.menus;return t.length?(l.forEach((function(n){t.find((function(e){return e.menu_id===n.menu_id}))||e.push(n)})),e):e}},watch:{pluginMenus:function(e){e.length||(this.currentTab="menus")}},methods:{enableChange:function(e){e.enable=!e.enable,d.collection("opendb-admin-menus").doc(e._id).update({enable:e.enable})},getSortMenu:function(e){return e.map((function(t){e.some((function(e){return e.parent_id===t.menu_id}))||(t.isLeafNode=!0)})),(0,u.buildMenus)(e)},onqueryload:function(e){for(var t=0;t<e.length;t++){var n=e[t],i=p(e,n.menu_id);n.name=(i?"　".repeat(i)+"|-":"")+n.name}var a=this.getSortMenu(e),s=[];this.patTree(a,s),e.length=0,e.push.apply(e,s),this.menus=e},patTree:function(e,t){var n=this;return e.forEach((function(e){t.push(e),e.children.length&&n.patTree(e.children,t)})),t},switchTab:function(e){this.currentTab=e},loadData:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$refs.udb.loadData({clear:e})},navigateTo:function(e,t){var n=this;uni.navigateTo({url:e,events:{refreshData:function(){n.loadData(t)}}})},confirmDelete:function(e){var t=this,n=e._id,i="是否删除该菜单？",a=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return t.find((function(e){return e.parent_id===n}))&&t.forEach((function(a){a.parent_id===n&&(i.push(a._id),e(t,a.menu_id,i))})),i}(this.menus,e.menu_id);a.length&&(i="是否删除该菜单及其子菜单？"),n=[n].concat((0,r.default)(a)),uni.showModal({title:"提示",content:i,success:function(e){e.confirm&&t.$refs.udb.remove(n,{needConfirm:!1})}})},pluginMenuSelectChange:function(e){this.selectedPluginMenuIndexs=e.detail.index},addPluginMenus:function(t){var n=this;if(!this.selectedPluginMenuIndexs.length)return uni.showModal({title:"提示",content:"请选择要添加的菜单！",showCancel:!1});var i=this.pluginMenus,a=[];this.selectedPluginMenuIndexs.forEach((function(e){var t=i[e];if(t){var n=JSON.parse(JSON.stringify(t));n.enable=!0,delete n.json,a.push(n)}})),uni.showModal({title:"提示",content:"您确认要添加已选中的菜单吗？",success:function(t){if(t.confirm){uni.showLoading({mask:!0});var s=a.length===i.length;e.database().collection("opendb-admin-menus").add(a).then((function(e){uni.showModal({title:"提示",content:"添加菜单成功！",showCancel:!1,success:function(){n.$refs.pluginMenusTable.clearSelection(),s&&(n.currentTab="menus"),n.loadData()}})})).catch((function(e){uni.showModal({title:"提示",content:e.message,showCancel:!1})})).finally((function(){uni.hideLoading()}))}}})},updateBuiltInMenu:function(){return(0,o.default)((0,a.default)().mark((function t(){return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:uni.showModal({title:"提示",content:"确定更新内置菜单吗？\n（该操作不会影响现有的菜单）",success:function(){var t=(0,o.default)((0,a.default)().mark((function t(n){var i,o,r,u,d,l,p;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.confirm){t.next=29;break}return i=e.database(),o=i.command,r=c.default.map((function(e,t){return e.menu_id})),uni.showLoading({title:"更新中...",mask:!0}),t.prev=5,u=[],t.next=9,i.collection("opendb-admin-menus").where({menu_id:o.in[r]}).limit(500).get();case 9:if(d=t.sent,l=d.result.data,c.default.map((function(e,t){var n=l.find((function(t,n,i){return t.menu_id===e.menu_id}));n||u.push((0,s.default)((0,s.default)({},e),{},{create_date:void 0}))})),!(u&&u.length>0)){t.next=20;break}return t.next=15,i.collection("opendb-admin-menus").add(u);case 15:p=t.sent,uni.showToast({title:"新增了".concat(p.result.inserted,"个菜单，即将刷新"),icon:"none"}),setTimeout((function(){window.location.reload()}),300),t.next=21;break;case 20:uni.showToast({title:"菜单无变动",icon:"none"});case 21:t.next=26;break;case 23:t.prev=23,t.t0=t["catch"](5);case 26:return t.prev=26,uni.hideLoading(),t.finish(26);case 29:case"end":return t.stop()}}),t,null,[[5,23,26,29]])})));return function(e){return t.apply(this,arguments)}}()});case 1:case"end":return t.stop()}}),t)})))()}}};t.default=m}).call(this,n("861b")["default"])},3220:function(e,t,n){"use strict";n.r(t);var i=n("90e4"),a=n("49df");for(var s in a)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(s);var o=n("828b"),r=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);t["default"]=r.exports},"48b1":function(e,t,n){"use strict";n.r(t);var i=n("a8ce"),a=n("9469"),s=n("affd"),o=n("6aea"),r=n("e7f2");t["default"]={en:i,es:a,fr:s,"zh-Hans":o,"zh-Hant":r}},"49df":function(e,t,n){"use strict";n.r(t);var i=n("db82"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=a.a},"4aa6":function(e,t,n){"use strict";n.r(t);var i=n("25ed"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=a.a},"6aea":function(e){e.exports=JSON.parse('{"uniCloud.component.add.success":"新增成功","uniCloud.component.update.success":"修改成功","uniCloud.component.update.showModal.title":"提示","uniCloud.component.update.showModal.content":"是否更新该数据","uniCloud.component.remove.showModal.title":"提示","uniCloud.component.remove.showModal.content":"是否删除该数据"}')},"6af2":function(e){e.exports=JSON.parse('[{"menu_id":"index","name":"首页","icon":"uni-icons-home","url":"/","sort":100,"parent_id":"","permission":[],"enable":true,"create_date":1602662469396},{"menu_id":"system_management","name":"系统管理","icon":"admin-icons-fl-xitong","url":"","sort":1000,"parent_id":"","permission":[],"enable":true,"create_date":1602662469396},{"menu_id":"system_user","name":"用户管理","icon":"admin-icons-manager-user","url":"/pages/system/user/list","sort":1010,"parent_id":"system_management","permission":[],"enable":true,"create_date":1602662469398},{"menu_id":"system_role","name":"角色管理","icon":"admin-icons-manager-role","url":"/pages/system/role/list","sort":1020,"parent_id":"system_management","permission":[],"enable":true,"create_date":1602662469397},{"menu_id":"system_permission","name":"权限管理","icon":"admin-icons-manager-permission","url":"/pages/system/permission/list","sort":1030,"parent_id":"system_management","permission":[],"enable":true,"create_date":1602662469396},{"menu_id":"system_menu","name":"菜单管理","icon":"admin-icons-manager-menu","url":"/pages/system/menu/list","sort":1040,"parent_id":"system_management","permission":[],"enable":true,"create_date":1602662469396},{"menu_id":"system_app","name":"应用管理","icon":"admin-icons-manager-app","url":"/pages/system/app/list","sort":1035,"parent_id":"system_management","permission":[],"enable":true,"create_date":1602662469399},{"menu_id":"system_update","name":"App升级中心","icon":"uni-icons-cloud-upload","url":"/uni_modules/uni-upgrade-center/pages/version/list","sort":1036,"parent_id":"system_management","permission":[],"enable":true,"create_date":1656491532434},{"menu_id":"system_tag","name":"标签管理","icon":"admin-icons-manager-tag","url":"/pages/system/tag/list","sort":1037,"parent_id":"system_management","permission":[],"enable":true,"create_date":1602662479389},{"permission":[],"enable":true,"menu_id":"safety_statistics","name":"安全审计","icon":"admin-icons-safety","url":"","sort":3100,"parent_id":"","create_date":1638356430871},{"permission":[],"enable":true,"menu_id":"safety_statistics_user_log","name":"用户日志","icon":"","url":"/pages/system/safety/list","sort":3101,"parent_id":"safety_statistics","create_date":1638356430871},{"permission":[],"enable":true,"menu_id":"uni-stat","name":"uni 统计","icon":"admin-icons-tongji","url":"","sort":2100,"parent_id":"","create_date":1638356430871},{"parent_id":"uni-stat","permission":[],"enable":true,"menu_id":"uni-stat-device","name":"设备统计","icon":"admin-icons-shebeitongji","url":"","sort":2120,"create_date":1638356902516},{"parent_id":"uni-stat-device","permission":[],"enable":true,"menu_id":"uni-stat-device-overview","name":"概况","icon":"","url":"/pages/uni-stat/device/overview/overview","sort":2121,"create_date":1638356902516},{"parent_id":"uni-stat-device","permission":[],"enable":true,"menu_id":"uni-stat-device-activity","name":"活跃度","icon":"","url":"/pages/uni-stat/device/activity/activity","sort":2122,"create_date":1638356902516},{"parent_id":"uni-stat-device","permission":[],"enable":true,"menu_id":"uni-stat-device-trend","name":"趋势分析","icon":"","url":"/pages/uni-stat/device/trend/trend","sort":2123,"create_date":1638356902516},{"parent_id":"uni-stat-device","permission":[],"enable":true,"menu_id":"uni-stat-device-retention","name":"留存","icon":"","url":"/pages/uni-stat/device/retention/retention","sort":2124,"create_date":1638356902516},{"parent_id":"uni-stat-device","permission":[],"enable":true,"menu_id":"uni-stat-device-comparison","name":"平台对比","icon":"","url":"/pages/uni-stat/device/comparison/comparison","sort":2125,"create_date":1638356902516},{"parent_id":"uni-stat-device","permission":[],"enable":true,"menu_id":"uni-stat-device-stickiness","name":"粘性","icon":"","url":"/pages/uni-stat/device/stickiness/stickiness","sort":2126,"create_date":1638356902516},{"parent_id":"uni-stat","permission":[],"enable":true,"menu_id":"uni-stat-user","name":"注册用户统计","icon":"admin-icons-yonghutongji","url":"","sort":2122,"create_date":1638356902516},{"parent_id":"uni-stat-user","permission":[],"enable":true,"menu_id":"uni-stat-user-overview","name":"概况","icon":"","url":"/pages/uni-stat/user/overview/overview","sort":2121,"create_date":1638356902516},{"parent_id":"uni-stat-user","permission":[],"enable":true,"menu_id":"uni-stat-user-activity","name":"活跃度","icon":"","url":"/pages/uni-stat/user/activity/activity","sort":2122,"create_date":1638356902516},{"parent_id":"uni-stat-user","permission":[],"enable":true,"icon":"","menu_id":"uni-stat-user-trend","name":"趋势分析","url":"/pages/uni-stat/user/trend/trend","sort":2123,"create_date":1638356902516},{"parent_id":"uni-stat-user","permission":[],"enable":true,"menu_id":"uni-stat-user-retention","name":"留存","icon":"","url":"/pages/uni-stat/user/retention/retention","sort":2124,"create_date":1638356902516},{"parent_id":"uni-stat-user","permission":[],"enable":true,"menu_id":"uni-stat-user-comparison","name":"平台对比","icon":"","url":"/pages/uni-stat/user/comparison/comparison","sort":2125,"create_date":1638356902516},{"parent_id":"uni-stat-user","permission":[],"enable":true,"menu_id":"uni-stat-user-stickiness","name":"粘性","icon":"","url":"/pages/uni-stat/user/stickiness/stickiness","sort":2126,"create_date":1638356902516},{"parent_id":"uni-stat","permission":[],"enable":true,"menu_id":"uni-stat-page-analysis","name":"页面统计","icon":"admin-icons-page-ent","url":"","sort":2123,"create_date":1638356902516},{"parent_id":"uni-stat-page-analysis","permission":[],"enable":true,"menu_id":"uni-stat-page-res","name":"受访页","icon":"","url":"/pages/uni-stat/page-res/page-res","sort":2131,"create_date":1638356902516},{"parent_id":"uni-stat-page-analysis","permission":[],"enable":true,"menu_id":"uni-stat-page-ent","name":"入口页","icon":"","url":"/pages/uni-stat/page-ent/page-ent","sort":2132,"create_date":1638356902516},{"parent_id":"uni-stat","permission":[],"enable":true,"menu_id":"uni-stat-page-content-analysis","name":"内容统计","icon":"admin-icons-doc","url":"","sort":2140,"create_date":1638356902516},{"parent_id":"uni-stat-page-content-analysis","permission":[],"enable":true,"menu_id":"uni-stat-page-content","name":"内容统计","icon":"","url":"/pages/uni-stat/page-content/page-content","sort":2141,"create_date":1638356902516},{"parent_id":"uni-stat-page-content-analysis","permission":[],"enable":true,"menu_id":"uni-stat-page-rule","name":"页面规则","icon":"","url":"/pages/uni-stat/page-rule/page-rule","sort":2142,"create_date":1638356902516},{"parent_id":"uni-stat","permission":[],"enable":true,"menu_id":"uni-stat-senceChannel","name":"渠道/场景值分析","icon":"admin-icons-qudaofenxi","url":"","sort":2150,"create_date":1638356902516},{"parent_id":"uni-stat-senceChannel","permission":[],"enable":true,"menu_id":"uni-stat-senceChannel-scene","name":"场景值（小程序）","icon":"","url":"/pages/uni-stat/scene/scene","sort":2151,"create_date":1638356902516},{"parent_id":"uni-stat-senceChannel","permission":[],"enable":true,"menu_id":"uni-stat-senceChannel-channel","name":"渠道（app）","icon":"","url":"/pages/uni-stat/channel/channel","sort":2152,"create_date":1638356902516},{"parent_id":"uni-stat","permission":[],"enable":true,"menu_id":"uni-stat-event-event","name":"自定义事件","icon":"admin-icons-shijianfenxi","url":"/pages/uni-stat/event/event","sort":2160,"create_date":1638356902516},{"parent_id":"uni-stat","permission":[],"enable":true,"menu_id":"uni-stat-error","name":"错误统计","icon":"admin-icons-cuowutongji","url":"","sort":2170,"create_date":1638356902516},{"parent_id":"uni-stat-error","permission":[],"enable":true,"menu_id":"uni-stat-error-js","name":"js报错","icon":"","url":"/pages/uni-stat/error/js/js","sort":2171,"create_date":1638356902516},{"parent_id":"uni-stat-error","permission":[],"enable":true,"menu_id":"uni-stat-error-app","name":"app崩溃","icon":"","url":"/pages/uni-stat/error/app/app","sort":2172,"create_date":1638356902516},{"menu_id":"uni-stat-pay","name":"支付统计","icon":"uni-icons-circle","url":"","sort":2122,"parent_id":"uni-stat","permission":[],"enable":true,"create_date":1667386977981},{"menu_id":"uni-stat-pay-overview","name":"概况","icon":"","url":"/pages/uni-stat/pay-order/overview/overview","sort":21221,"parent_id":"uni-stat-pay","permission":[],"enable":true,"create_date":1667387038602},{"menu_id":"uni-stat-pay-funnel","name":"转换漏斗分析","icon":"","url":"/pages/uni-stat/pay-order/funnel/funnel","sort":21222,"parent_id":"uni-stat-pay","permission":[],"enable":true,"create_date":1668430092890},{"menu_id":"uni-stat-pay-ranking","name":"价值用户排行","icon":"","url":"/pages/uni-stat/pay-order/ranking/ranking","sort":21223,"parent_id":"uni-stat-pay","permission":[],"enable":true,"create_date":1668430128302},{"menu_id":"uni-stat-pay-order-list","name":"订单明细","icon":"","url":"/pages/uni-stat/pay-order/list/list","sort":21224,"parent_id":"uni-stat-pay","permission":[],"enable":true,"create_date":1667387078947}]')},"90e4":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var i=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",[this._t("default",null,{options:this.options,data:this.dataList,pagination:this.paginationInternal,loading:this.loading,hasMore:this.hasMore,error:this.errorMessage})],2)},a=[]},9469:function(e){e.exports=JSON.parse('{"uniCloud.component.add.success":"新增成功","uniCloud.component.update.success":"修改成功","uniCloud.component.update.showModal.title":"提示","uniCloud.component.update.showModal.content":"是否更新该数据","uniCloud.component.remove.showModal.title":"提示","uniCloud.component.remove.showModal.content":"是否删除该数据"}')},a3f9:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i}));var i={uniStatBreadcrumb:n("ce4e").default,uniBadge:n("7375").default,unicloudDb:n("3220").default,uniTable:n("2565").default,uniTr:n("0f7c").default,uniTh:n("0fc6").default,uniTd:n("36a1").default},a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("v-uni-view",{staticClass:"uni-header"},[n("uni-stat-breadcrumb",{staticClass:"uni-stat-breadcrumb-on-phone"})],1),n("v-uni-view",{staticClass:"uni-tabs__header"},[n("v-uni-view",{staticClass:"uni-tabs__nav-wrap"},[n("v-uni-view",{staticClass:"uni-tabs__nav-scroll"},[n("v-uni-view",{staticClass:"uni-tabs__nav"},[n("v-uni-view",{staticClass:"uni-tabs__item",class:{"is-active":"menus"===e.currentTab},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.switchTab("menus")}}},[e._v(e._s(e.$t("menu.text.menuManager")))]),e.pluginMenus.length?n("v-uni-view",{staticClass:"uni-tabs__item",class:{"is-active":"pluginMenus"===e.currentTab},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.switchTab("pluginMenus")}}},[e._v(e._s(e.$t("menu.text.additiveMenu"))),n("uni-badge",{staticClass:"menu-badge",attrs:{text:e.pluginMenus.length,type:"error"}})],1):e._e()],1)],1)],1)],1),n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"menus"===e.currentTab,expression:"currentTab==='menus'"}]},[n("v-uni-view",{staticClass:"uni-header",staticStyle:{"border-bottom":"0","margin-bottom":"-15px"}},[n("v-uni-view",{staticClass:"uni-group"},[n("v-uni-button",{attrs:{size:"mini",plain:"true",type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.navigateTo("./add")}}},[e._v(e._s(e.$t("menu.button.addFirstLevelMenu")))]),n("v-uni-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",plain:"true",type:"warn"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.updateBuiltInMenu.apply(void 0,arguments)}}},[e._v(e._s(e.$t("menu.button.updateBuiltInMenu")))])],1),n("v-uni-view",{staticClass:"uni-group"})],1),n("v-uni-view",{staticClass:"uni-container"},[n("unicloud-db",{ref:"udb",attrs:{collection:"opendb-admin-menus",options:e.options,where:e.where,"page-data":"replace",orderby:e.orderby,getcount:!0,"page-size":e.options.pageSize,"page-current":e.options.pageCurrent},on:{load:function(t){arguments[0]=t=e.$handleEvent(t),e.onqueryload.apply(void 0,arguments)}},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.data,a=(t.pagination,t.loading);t.error;return[n("uni-table",{staticClass:"table-pc",attrs:{loading:a,emptyText:e.errMsg||e.$t("common.empty"),border:!0,stripe:!0}},[n("uni-tr",[n("uni-th",{attrs:{align:"center"}},[e._v("排序")]),n("uni-th",{attrs:{width:"200",align:"center"}},[e._v("名称")]),n("uni-th",{attrs:{align:"center"}},[e._v("标识")]),n("uni-th",{attrs:{align:"center"}},[e._v("URL")]),n("uni-th",{attrs:{width:"100",align:"center"}},[e._v("是否启用")]),n("uni-th",{attrs:{align:"center"}},[e._v("操作")])],1),e._l(i,(function(t,i){return n("uni-tr",{key:i},[n("uni-td",{attrs:{align:"center"}},[e._v(e._s(t.sort))]),n("uni-td",[e._v(e._s(t.name))]),n("uni-td",[e._v(e._s(t.menu_id))]),n("uni-td",[e._v(e._s(t.url))]),n("uni-td",{class:{"menu-disable":!t.enable},attrs:{align:"center"}},[n("v-uni-switch",{attrs:{checked:t.enable},on:{change:function(n){arguments[0]=n=e.$handleEvent(n),e.enableChange(t)}}})],1),n("uni-td",{attrs:{align:"center"}},[n("v-uni-view",{staticClass:"uni-group",staticStyle:{"justify-content":"left"}},[n("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"primary"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.navigateTo("./edit?id="+t._id,!1)}}},[e._v(e._s(e.$t("common.button.edit")))]),"system_menu"!==t.menu_id&&"system_management"!==t.menu_id?n("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"warn"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.confirmDelete(t)}}},[e._v(e._s(e.$t("common.button.delete")))]):e._e(),t.url?e._e():n("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"primary"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.navigateTo("./add?parent_id="+t.menu_id,!1)}}},[e._v(e._s(e.$t("menu.button.addChildMenu")))])],1)],1)],1)}))],2)]}}])})],1)],1),n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"pluginMenus"===e.currentTab,expression:"currentTab==='pluginMenus'"}]},[n("v-uni-view",{staticClass:"uni-header",staticStyle:{"border-bottom":"0","margin-bottom":"-15px"}},[n("v-uni-view",{staticClass:"uni-group"},[n("v-uni-button",{staticStyle:{width:"130px"},attrs:{size:"mini",type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.addPluginMenus.apply(void 0,arguments)}}},[e._v("添加选中的菜单")])],1),n("v-uni-view",{staticClass:"uni-group"})],1),n("v-uni-view",{staticClass:"uni-container"},[n("uni-table",{ref:"pluginMenusTable",attrs:{type:"selection",border:!0,stripe:!0},on:{"selection-change":function(t){arguments[0]=t=e.$handleEvent(t),e.pluginMenuSelectChange.apply(void 0,arguments)}}},[n("uni-tr",[n("uni-th",{attrs:{align:"center"}},[e._v("名称（标识）")]),n("uni-th",{attrs:{align:"center"}},[e._v("URL")]),n("uni-th",{attrs:{align:"center"}},[e._v("插件菜单 json 文件")])],1),e._l(e.pluginMenus,(function(t,i){return n("uni-tr",{key:i},[n("uni-td",[e._v(e._s(t.name)+"（"+e._s(t.menu_id)+"）")]),n("uni-td",[e._v(e._s(t.url))]),n("uni-td",[e._v(e._s(t.json))])],1)}))],2),n("v-uni-view",{staticClass:"uni-sub-title",staticStyle:{"margin-top":"15px"}},[e._v("以上待添加菜单来自于三方插件，添加后，将显示在菜单管理中，若不希望显示在上述表格中时，可手动删除项目中对应的`插件id-menu.json`文件。")])],1)],1)],1)},s=[]},a578:function(e,t,n){"use strict";var i=n("8bdb"),a=n("f298");i({target:"String",proto:!0},{repeat:a})},a8ce:function(e){e.exports=JSON.parse('{"uniCloud.component.add.success":"Success","uniCloud.component.update.success":"Success","uniCloud.component.update.showModal.title":"Tips","uniCloud.component.update.showModal.content":"是否更新该数据","uniCloud.component.remove.showModal.title":"Tips","uniCloud.component.remove.showModal.content":"是否删除该数据"}')},affd:function(e){e.exports=JSON.parse('{"uniCloud.component.add.success":"新增成功","uniCloud.component.update.success":"修改成功","uniCloud.component.update.showModal.title":"提示","uniCloud.component.update.showModal.content":"是否更新该数据","uniCloud.component.remove.showModal.title":"提示","uniCloud.component.remove.showModal.content":"是否删除该数据"}')},c638:function(e,t,n){"use strict";n.r(t);var i=n("a3f9"),a=n("4aa6");for(var s in a)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(s);n("ddc2");var o=n("828b"),r=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,"06a23af1",null,!1,i["a"],void 0);t["default"]=r.exports},db82:function(e,t,n){"use strict";(function(e){n("6a54");var i=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n("b7c7")),s=i(n("fcf3"));n("64aa"),n("5ef2"),n("bf0f"),n("aa9c"),n("dd2b"),n("5c47"),n("d4b5"),n("dc8a"),n("7a76"),n("c9b5"),n("f7a5");var o=n("d3b4"),r=i(n("48b1")),u=(0,o.initVueI18n)(r.default),c=u.t,d={load:"load",error:"error"},l={add:"add",replace:"replace"},p={auto:"auto",onready:"onready",manual:"manual"},m=["pageCurrent","pageSize","spaceInfo","collection","action","field","getcount","orderby","where","groupby","groupField","distinct"],f={name:"UniClouddb",props:{options:{type:[Object,Array],default:function(){return{}}},spaceInfo:{type:Object,default:function(){return{}}},collection:{type:[String,Array],default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},getone:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String,Object],default:!1},gettreepath:{type:[Boolean,String],default:!1},startwith:{type:String,default:""},limitlevel:{type:Number,default:10},groupby:{type:String,default:""},groupField:{type:String,default:""},distinct:{type:[Boolean,String],default:!1},pageIndistinct:{type:[Boolean,String],default:!1},foreignKey:{type:String,default:""},loadtime:{type:String,default:"auto"},manual:{type:Boolean,default:!1}},data:function(){return{loading:!1,hasMore:!1,dataList:this.getone?void 0:[],paginationInternal:{},errorMessage:""}},computed:{collectionArgs:function(){return Array.isArray(this.collection)?this.collection:[this.collection]},isLookup:function(){return Array.isArray(this.collection)&&this.collection.length>1||"string"===typeof this.collection&&this.collection.indexOf(",")>-1}},created:function(){var e=this;this._isEnded=!1,this.paginationInternal={current:this.pageCurrent,size:this.pageSize,count:0},this.$watch((function(){var t=[];return m.forEach((function(n){t.push(e[n])})),t}),(function(t,n){if(e.paginationInternal.size=e.pageSize,t[0]!==n[0]&&(e.paginationInternal.current=e.pageCurrent),e.loadtime!==p.manual){for(var i=!1,a=2;a<t.length;a++)if(t[a]!==n[a]){i=!0;break}i&&(e.clear(),e.reset()),e._execLoadData()}})),this.manual||this.loadtime!==p.auto||this.loadData()},beforeDestroy:function(){},methods:{loadData:function(e,t){var n=null,i=!1;"object"===(0,s.default)(e)?(e.clear&&(this.pageData===l.replace?this.clear():i=e.clear,this.reset()),void 0!==e.current&&(this.paginationInternal.current=e.current),"function"===typeof t&&(n=t)):"function"===typeof e&&(n=e),this._execLoadData(n,i)},loadMore:function(){this._isEnded||this.loading||(this.pageData===l.add&&this.paginationInternal.current++,this._execLoadData())},refresh:function(){this.clear(),this._execLoadData()},clear:function(){this._isEnded=!1,this.dataList=[]},reset:function(){this.paginationInternal.current=1},add:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.action,a=n.showToast,s=void 0===a||a,o=n.toastTitle,r=n.success,u=n.fail,d=n.complete,l=n.needConfirm,p=void 0===l||l,m=n.needLoading,f=void 0===m||m,h=n.loadingTitle,g=void 0===h?"":h;f&&uni.showLoading({title:g});var _=e.database(this.spaceInfo);i&&(_=_.action(i)),_.collection(this.getMainCollection()).add(t).then((function(e){r&&r(e),s&&uni.showToast({title:o||c("uniCloud.component.add.success")})})).catch((function(e){u&&u(e),p&&uni.showModal({content:e.message,showCancel:!1})})).finally((function(){f&&uni.hideLoading(),d&&d()}))},remove:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.action,a=n.success,s=n.fail,o=n.complete,r=n.confirmTitle,u=n.confirmContent,d=n.needConfirm,l=void 0===d||d,p=n.needLoading,m=void 0===p||p,f=n.loadingTitle,h=void 0===f?"":f;e&&e.length&&(l?uni.showModal({title:r||c("uniCloud.component.remove.showModal.title"),content:u||c("uniCloud.component.remove.showModal.content"),showCancel:!0,success:function(n){n.confirm&&t._execRemove(e,i,a,s,o,l,m,h)}}):this._execRemove(e,i,a,s,o,l,m,h))},update:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object.assign({action:null,showToast:!0,toastTitle:null,success:null,fail:null,complete:null,confirmTitle:null,confirmContent:null,needConfirm:!0,needLoading:!0,loadingTitle:""},i);i.needConfirm?this._doUpdate(e,t,a):uni.showModal({title:i.confirmTitle||c("uniCloud.component.update.showModal.title"),content:i.confirmContent||c("uniCloud.component.update.showModal.content"),showCancel:!0,success:function(i){i.confirm&&n._doUpdate(e,t,a)}})},_doUpdate:function(t,n,i){var a=i.action,s=i.success,o=i.fail,r=i.complete,u=i.showToast,d=i.toastTitle,l=i.needConfirm,p=i.needLoading,m=i.loadingTitle;p&&uni.showLoading({title:m});var f=e.database(this.spaceInfo);a&&(f=f.action(a)),f.collection(this.getMainCollection()).doc(t).update(n).then((function(e){s&&s(e),u&&uni.showToast({title:d||c("uniCloud.component.update.success")})})).catch((function(e){o&&o(e),l&&uni.showModal({content:e.message,showCancel:!1})})).finally((function(){p&&uni.hideLoading(),r&&r()}))},getMainCollection:function(){if("string"===typeof this.collection)return this.collection.split(",")[0];var e=JSON.parse(JSON.stringify(this.collection[0]));return e.$db[0].$param[0]},getTemp:function(){var t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=e.database(this.spaceInfo);this.action&&(i=i.action(this.action)),i=(t=i).collection.apply(t,(0,a.default)(this.collectionArgs)),this.foreignKey&&(i=i.foreignKey(this.foreignKey)),this.where&&Object.keys(this.where).length&&(i=i.where(this.where)),this.field&&(i=i.field(this.field)),this.groupby&&(i=i.groupBy(this.groupby)),this.groupField&&(i=i.groupField(this.groupField)),!0===this.distinct&&(i=i.distinct()),this.orderby&&(i=i.orderBy(this.orderby));var s=this.paginationInternal,o=s.current,r=s.size,u={};this.getcount&&(u.getCount=this.getcount);var c={limitLevel:this.limitlevel,startWith:this.startwith};return this.gettree&&(u.getTree=c),this.gettreepath&&(u.getTreePath=c),i=i.skip(r*(o-1)).limit(r),n?(i=i.getTemp(u),i.udb=this):i=i.get(u),i},setResult:function(e){0===e.code?this._execLoadDataSuccess(e):this._execLoadDataFail(new Error(e.message))},_execLoadData:function(e,t){var n=this;this.loading||(this.loading=!0,this.errorMessage="",this._getExec().then((function(i){n.loading=!1,n._execLoadDataSuccess(i.result,e,t)})).catch((function(t){n.loading=!1,n._execLoadDataFail(t,e)})))},_execLoadDataSuccess:function(e,t,n){var i=e.data,s=e.count;this._isEnded=void 0!==s?this.paginationInternal.current*this.paginationInternal.size>=s:i.length<this.pageSize,this.hasMore=!this._isEnded;var o,r=this.getone?i.length?i[0]:void 0:i;(this.getcount&&(this.paginationInternal.count=s),t&&t(r,this._isEnded,this.paginationInternal),this._dispatchEvent(d.load,r),this.getone||this.pageData===l.replace)?this.dataList=r:n?this.dataList=r:(o=this.dataList).push.apply(o,(0,a.default)(r))},_execLoadDataFail:function(e,t){this.errorMessage=e,t&&t(),this.$emit(d.error,e)},_getExec:function(){return this.getTemp(!1)},_execRemove:function(t,n,i,a,s,o,r,u){var c=this;if(this.collection&&t){var d=Array.isArray(t)?t:[t];if(d.length){r&&uni.showLoading({mask:!0,title:u});var p=e.database(this.spaceInfo),m=p.command,f=p;n&&(f=f.action(n)),f.collection(this.getMainCollection()).where({_id:m.in(d)}).remove().then((function(e){i&&i(e.result),c.pageData===l.replace?c.refresh():c.removeData(d)})).catch((function(e){a&&a(e),o&&uni.showModal({content:e.message,showCancel:!1})})).finally((function(){r&&uni.hideLoading(),s&&s()}))}}},removeData:function(e){for(var t=e.slice(0),n=this.dataList,i=n.length-1;i>=0;i--){var a=t.indexOf(n[i]._id);a>=0&&(n.splice(i,1),t.splice(a,1))}},_dispatchEvent:function(e,t){this._changeDataFunction?this._changeDataFunction(t,this._isEnded,this.paginationInternal):this.$emit(e,t,this._isEnded,this.paginationInternal)}}};t.default=f}).call(this,n("861b")["default"])},ddc2:function(e,t,n){"use strict";var i=n("083a"),a=n.n(i);a.a},df4d:function(e,t,n){var i=n("c86c");t=i(!1),t.push([e.i,"\n.menu-disable[data-v-06a23af1]{color:red}.menu-badge[data-v-06a23af1]{position:absolute;top:0;right:5px}",""]),e.exports=t},e7f2:function(e){e.exports=JSON.parse('{"uniCloud.component.add.success":"新增成功","uniCloud.component.update.success":"修改成功","uniCloud.component.update.showModal.title":"提示","uniCloud.component.update.showModal.content":"是否更新该数据","uniCloud.component.remove.showModal.title":"提示","uniCloud.component.remove.showModal.content":"是否刪除數據"}')},f298:function(e,t,n){"use strict";var i=n("497b"),a=n("9e70"),s=n("862c"),o=RangeError;e.exports=function(e){var t=a(s(this)),n="",r=i(e);if(r<0||r===1/0)throw new o("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}}}]);